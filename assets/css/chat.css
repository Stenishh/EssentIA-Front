/* ===== Tokens ===== */
:root{
  --ia-green:#1B4D3E; --ia-green-2:#2C7A64; --bg:#F4F8F6; --muted:#6B7280;
  --chat-max-width:880px; --avatar-size:44px; --sidebar-width:300px; --hamburger-size:56px;
  --bubble-padding-vertical:1rem; --bubble-padding-horizontal:1.25rem; --bubble-radius:14px;
  --input-padding-vertical:1rem; --input-padding-horizontal:1.25rem;

  /* Altura real da pílula (JS atualiza na carga/resize) */
  --input-height: 64px;

  /* Posição vertical animável da pílula */
  --input-top: calc(100vh - 24px - var(--input-height));
}

*{box-sizing:border-box}

.chat-fullpage{height:100vh;width:100%;display:flex;background:var(--bg);}

/* ===== Sidebar ===== */
.chat-sidebar{
  width:var(--sidebar-width);background:#fff;border-right:1px solid rgba(0,0,0,.05);
  padding:1rem;display:flex;flex-direction:column;gap:1rem;position:fixed;inset:0 auto 0 0;
  z-index:90;transform:translateX(-100%);transition:transform .25s ease,box-shadow .25s ease,z-index .25s ease;
}
.chat-sidebar.open{transform:translateX(0);z-index:160;box-shadow:0 24px 60px rgba(0,0,0,.28);}

.chat-sidebar .brand{position:relative;display:flex;align-items:center;gap:.75rem;padding:.25rem 0;}
.chat-sidebar .brand img{width:var(--avatar-size);height:var(--avatar-size);}
.chat-sidebar .brand h1{font-size:1.05rem;color:var(--ia-green);margin:0;font-weight:700;}
/* reserva espaço à direita do nome quando o botão entra no cabeçalho */
body.sidebar-open .chat-sidebar .brand{padding-right:calc(var(--hamburger-size) + 22px);padding-left:0;}

.chat-main{margin-left:0;flex:1;display:flex;flex-direction:column;height:100vh;position:relative;}
.chat-sidebar.open ~ .chat-main{margin-left:260px;}

.sidebar-controls{display:flex;flex-direction:column;gap:.5rem}
.history-search{padding:.5rem .75rem;border-radius:8px;border:1px solid rgba(0,0,0,.06);outline:none}
.history-list{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:.375rem}
.history-item{display:flex;align-items:center;gap:.75rem;padding:.5rem;border-radius:8px;color:#234;cursor:pointer}
.history-item:hover{background:rgba(40,110,80,0.06)}
.history-item.active{background:rgba(28,77,50,0.08);font-weight:600}
.history-item img{width:var(--avatar-size);height:var(--avatar-size);border-radius:8px;object-fit:cover}
.history-item .meta{display:flex;flex-direction:column}
.history-item .meta .title{font-size:1.05rem;color:var(--ia-green-2)}
.history-item .meta .subtitle{font-size:.9rem;color:var(--muted)}

.sidebar-footer{margin-top:auto;padding-top:1rem;border-top:1px solid rgba(0,0,0,.03)}
.sidebar-footer .profile{display:flex;gap:.75rem;align-items:center}
.sidebar-footer img{width:48px;height:48px;border-radius:8px}
.sidebar-footer .meta .name{font-weight:700}
.sidebar-footer .meta .link{font-size:.85rem;color:var(--ia-green);text-decoration:none}

/* ===== Chat area ===== */
.chat-area{flex:1;overflow:auto;padding:2rem;display:flex;flex-direction:column;gap:1rem;align-items:center;}
.chat-column{width:100%;max-width:var(--chat-max-width);min-height:calc(100vh - 180px);display:flex;flex-direction:column;gap:1rem;position:relative;padding-bottom:80px;}
.chat-column.empty{justify-content:center;align-items:center;}

/* Mensagens */
.message-row{display:flex;gap:1.25rem;align-items:flex-end;width:100%;}
.message-row.ai{align-items:flex-start}
.message-bubble{max-width:75%;padding:var(--bubble-padding-vertical) var(--bubble-padding-horizontal);border-radius:var(--bubble-radius);background:#fff;color:#111;border:1px solid rgba(0,0,0,.04);font-size:1rem}
.message-bubble.ai{background:#E8F3F0;color:var(--ia-green);border:none;border-top-left-radius:6px}
.message-bubble.user{background:var(--ia-green);color:#fff;border-bottom-right-radius:6px;margin-left:auto}
.message-row.user{justify-content:flex-end}
.avatar{width:var(--avatar-size);height:var(--avatar-size);border-radius:50%;object-fit:cover}
.avatar-container{display:flex;align-items:flex-end}

/* ===== Pílula (com transição suave) ===== */
.input-bar{
  position:fixed;
  left:50%;
  top:var(--input-top);                  /* usa variável para animar */
  transform:translateX(-50%);
  width:clamp(280px,92vw,var(--chat-max-width));
  z-index:80;
  padding:0 !important;
  background:transparent !important;
  border:none !important;
  display:flex;justify-content:center;pointer-events:none;

  /* animação */
  transition:
    top 320ms cubic-bezier(.2,.7,.3,1),
    transform 320ms cubic-bezier(.2,.7,.3,1),
    width 260ms ease;
}
.input-row{
  width:100%;display:grid;grid-template-columns:1fr auto;gap:.5rem;align-items:center;background:#fff;
  border:1px solid rgba(0,0,0,.08);border-radius:999px;padding:.5rem .5rem;box-shadow:0 10px 28px rgba(0,0,0,.14);pointer-events:auto;
}
.input-row input{min-width:0;padding:1rem 1.25rem;border-radius:999px;border:none;outline:none;background:transparent;font-size:1rem}
.btn-primary{background:var(--ia-green);color:#fff;padding:.6rem 1rem;border-radius:999px;border:none;cursor:pointer}

/* Estado: TELA INICIAL (centro) — apenas ajusta a var e largura */
.chat-fullpage.compose-center .input-bar,
.chat-main.compose-center .input-bar{
  --input-top: calc(50vh - var(--input-height)/2);
  width:clamp(300px,92vw,720px);
}

/* Esconde o feed quando na tela inicial */
.chat-fullpage.compose-center .chat-area,
.chat-fullpage.compose-center .chat-column{display:none !important}

/* ===== Botão hamburger ===== */
.hamburger-btn{
  position:fixed;top:20px;left:20px;width:var(--hamburger-size);height:var(--hamburger-size);
  border-radius:12px;background:#fff;border:1px solid rgba(0,0,0,.1);box-shadow:0 6px 18px rgba(0,0,0,.12);
  cursor:pointer;z-index:200;display:flex;align-items:center;justify-content:center;
  transition:left .25s ease,top .25s ease,background-color .2s,box-shadow .2s;
}
.hamburger-btn:hover{background:#f8f8f8}
.hamburger-btn svg{color:var(--ia-green)}
/* Sidebar aberta: botão vai para a DIREITA do cabeçalho */
body.sidebar-open .hamburger-btn{left:calc(var(--sidebar-width) - var(--hamburger-size) - 20px);top:20px;z-index:170;box-shadow:0 4px 12px rgba(0,0,0,.10)}

/* ===== HERO ===== */
.welcome-hero{
  position:fixed;left:50%;top:34vh;transform:translateX(-50%);display:none;
  flex-direction:column;align-items:center;gap:.75rem;text-align:center;z-index:70;width:min(1000px,92vw);padding:0 .5rem
}
.welcome-hero .hero-title{
  font-size:clamp(1.15rem,5.2vw,2.4rem);
  line-height:1.15;font-weight:800;color:#111;letter-spacing:.1px;text-wrap:balance;overflow-wrap:break-word;hyphens:auto
}
.chat-main.compose-center .welcome-hero,
.chat-fullpage.compose-center .welcome-hero{display:flex !important}
.welcome-hero.hidden{display:none !important}

/* ===== Responsivo ===== */
@media (max-width:900px){
  .chat-sidebar{transform:translateX(-100%);position:fixed;z-index:90}
  .chat-sidebar.open{transform:translateX(0);z-index:160}
  .chat-main{margin-left:0}
  .welcome-hero{top:32vh}
  body.sidebar-open .hamburger-btn{left:calc(var(--sidebar-width) - var(--hamburger-size) - 20px)}
}
@media (max-width:600px){
  .welcome-hero{top:30vh}
  .input-row{padding:.35rem .4rem}
  .input-row input{padding:.8rem 1rem;font-size:.95rem}
  .btn-primary{padding:.65rem .9rem;font-size:.95rem}
}
@media (max-width:420px){
  .welcome-hero{top:28vh}
  .input-row{grid-template-columns:1fr;row-gap:.5rem;border-radius:18px;padding:.5rem}
  .btn-primary{width:100%;border-radius:12px}
}
@media (max-height:700px){.welcome-hero{top:26vh}}
@media (max-height:560px){.welcome-hero{top:22vh}}
